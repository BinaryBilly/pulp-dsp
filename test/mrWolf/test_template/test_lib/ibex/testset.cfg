# 
# Function Defines Below this
# 

FSIG = 'printf(\\\"Print Hello \\n\\\")'

###############################################################
# 
# Do not change below this line
# 
###############################################################

from plptest import *

TestConfig = c = {}

c['tests'] = [ ]

def check_output(config, output):
	
	for item in output.split('\n'):
		if 'Test passed:' in item:
			print(item)
		elif 'Total cycles:' in item:
			print(item)
		elif 'Instructions:' in item:
			print(item)

	# if output.find('Hello !') == -1:
		# return (False, "Didn't find output string")
	return (True, None)

def add_test(name,flags):
	return Test(
		name = 'test %s' % name,
		commands = [
			Shell('clean', 'make clean %s' % (flags)),
			Shell('gen', 'make gen'),
			Shell('build', 'make all %s' % (flags)),
			Shell('run', 'make run %s' % (flags)),
			Check('check', check_output)
		],
		timeout = 1000000
	)

FSIG = 'FSIG=\'-D FSIG=\"' + FSIG + '\"\''
c['tests'].append(add_test('hello', ''))
c['tests'].append(add_test('hello_fun', FSIG))
c['tests'].append(add_test('hello_perf',FSIG+' '+'TFLAGS=-DPERF'))